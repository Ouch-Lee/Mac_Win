# 论文撰写—一种外骨骼式手术机器人操作台设计

## 摘要

这篇文章主要介绍一种应用于自然孔腔手术(NOTES)手术机器人的外骨骼式操纵台的设计。操纵台的作用是佩戴在操纵者的手臂上以采集手部操纵指令，并将操纵动作传递到手术机器人，该装置具有5个主动自由度，分别对应——————。文章主要介绍该装置结构上的创新性，舒适性，并通过仿真检验其直觉映射控制效果————（舒适性，创新性，可行性），从多个角度介绍了该装置在消除手术过程中手部颤抖的贡献；通过推导主从两端的映射关系，并在仿真中验证了映射的可行性。



## Introduce

_____

​		自然孔腔内窥镜手术是一种借由内窥镜通过人体的自然孔腔到达病灶位置的外科手术，自1957年第一台光纤内窥镜成功完成诊断手术以来[1]，内窥镜技术得到广泛关注和发展，19世纪70年代人们开始设想借助内窥镜完成一些简易手术，1980年  Michael W.L. 首次对12名儿童和19名成人描述了“无需剖腹手术的胃造口术”(**这里改成英文**)[2]，验证了内窥镜手术的可行性，由此学者开始尝试使用内窥镜完成更复杂的手术，并于2005年被正式提出NOTES的概念[3]。相较于开放的剖腹手术，NOTES存在诸多优点，可以避免开放手术带来的伤口感染和切口疝的问题[4]，因此可以实现更快的术后恢复，减轻患者术后疼痛等问题。

​		早期的NOTES通过内窥镜及其配备的简易活检设备实现，只能进行简单活检和组织切除手术，为了完成更为复杂的手术，学者们设计了多种用于NOTES的手术机器人，它们通常具有相同的配置，集成摄像头的内窥镜主轴和从远端分支的两个手术臂 ，如  EndoSAMURAI[5]，Cobra[6], K-flex[7]。操作三角测量在柔性内窥镜手术中的灵巧检查和操作中起着至关重要的作用，该角度可以定义为两个仪器之间的远端姿势向量[8]，受限于结构，上述手术臂为单段连续体通常不具有良好的三角测量性，ANUBIScope[9], A flexible endoscopic surgical system[10] 将出口展开提供被动的三角测量性。

​		尽管NOTES手术机器人已经成了医疗设备领域的热门研究对象，但现有关于其操纵台介绍的文章较少。目前商业主流的操纵台，如达芬奇手术机器人[11]和Hugo[12]，其操作台均为6自由度，而大多NOTES手术机器人有4自由度，两者存在不兼容的情况。为了避免自由度冗余，早期类似于EndoSAMURAI和Cobra的手术机器人采用纯机械式的摇杆（[下图](https://link.springer.com/article/10.1007/s00464-012-2173-z/figures/1)），在实际手术中需要多个人配合操纵，过于简单的操纵台使得医生使用体验不佳，这样导致手术效率低，安全得不到保障。设计不良的界面会降低外科医生的人体工程学效果，并会阻碍机器人的接受度[13]，这一点在微创手术机器人设计中已经验证。   [KFLEX](https://onlinelibrary.wiley.com/doi/abs/10.1002/rcs.2078) 设计了一种简易的三联杆结构用于柔性臂的控制，可以实现更易让操纵者接收的“直觉控制”，但是结构设计过于简单，没有考虑人体工程学的问题，且没有考虑操作三角性的问题。

​	受前人工作的启发，我们提出了一种可以控制三角测量性的内窥镜双通道手术机器人模型，它由远近两段连续体组成，近端的偏转提供主动的三角测量性，同时可以增加手术时的灵活性，近端和远端协作完成手术动作；并根据该模型自由度设计了一种外骨骼式的手术机器人操纵台，可以利用人体手臂的其中5个自由度一对一控制手术机器人的关节，实现高效的直觉控制。在进行第一版样机测试时发现操纵者手部存在明显的生理抖动，为了改善抖动引起的末端震颤，我们在硬件和软件层面提出了改善方法；通过建立主端两端运动学模型，我们推导了从操纵台的驱动空间到末端执行器构型空间之间的映射关系，并在matlab中验证了映射关系的正确性。

​	本文的结构如下：在第二节阐述了主从两端自由度分布，以及对操作台的机械结构设计进行介绍；第三节主要关注在NOTES手术机器人在主端震颤过滤的东线；第四节推导了操纵台到柔性手术臂之间的运动学映射；第五节对全文进行了总结。



Flexible instruments with steerable heads and multi-instrument flexible devices are difficult to control manually using a single operator.[13](https://ieeexplore.ieee.org/abstract/document/9779312)

##  MECHANICAL DESIGN

字数，参考：750+1000+1000

### 主从端自由度配置

从端的设想结构如图（），柔性机械臂搭载在双通道的内窥镜上（这里找到具体的型号）；其近端连续体（橙色）由同向的单元连接而成，自然状态下保持笔直，在一对cable的驱动下朝两侧弯曲，以增大远端连续体（蓝色）之间的间距，提供较好的三角测量性；远端连续体相邻的单元正交排布，因此具有可以实现两个方向偏转，末端器械通过微型轴承连接在远端连续体上，具有绕轴旋转和开合的自由度。

主端操纵台的功能是精准捕捉并映射操纵者控制指令，力求满足人体工程学设计，避免影响手术医生上肢自由运动。合理的映射策略能够使得外科医生直观的进行操作，以减少学习曲线并提高手术的安全可靠性[]，末端执行器的自由度分布如下图Fig.2(a)，由于该结构灵感来源于人体双手，因此在自由度布局上与人体手臂自由度极为类似。根据这个性质，我们对操纵台的关节进行了初步的布局如下图Fig2(b)。

操纵者将手肘放在——以后，可以利用肩关节和手肘关节的前后和内外翻转运动，驱动操纵台底部由两个正交的平动关节，对应手术机器人末端的前后伸缩，以及负责调控三角测量性近端连续体的偏转；手指握在——处，配合手腕的关节偏转运动和滚动运动，驱动操纵台三轴交于一点的三联杆对应的旋转关节，实现执行端前端的两个方向偏转和连续体内部手术器械的绕轴旋转旋转。



### 设备实现

___

关于CAD渲染配色

底部使用：木材颜色

导轨可以使用墨绿色

打印机通过使用白色吧 

金属统统使用铝合金

我还是更倾向于介绍具体的机械结构：

操纵台每个方向的平动由两根【型号】平行的导轨实现，由于操作该机构时需要将手臂的重量搭载在平台上，相对于K-FLEX中单个导轨的设计，间隔一定距离的平行导轨可以避免手臂压力产生的倾覆力矩，每对导轨上的板子多采用铝合金材料，通过验证可以满足强度校验；导轨带来顺滑移动的同时，也带来了系统不稳定的问题，轻微的扰动即可导致末端出现预期以外的运动，因此在上述结构基础上，每个板子都配备了齿条，并与安装有齿轮的电机（）啮合装配，通过控制电机实现变阻抗控制，（使得平动的关节的可以灵活的改变），该方法同样可以应用在转动关节，实际上转动关节的实现更为简单，因为电机自身继承了提供旋转副的轴承。

与手部进行交互的结构可以看作一个三连杆，在原理上它与K-FLEX一样，但在此基础上我们做出了许多修改：首先我们额外增加了两条镜像连杆已经一些配重砝码，好处是使得外部更美观，更重要的是增加结构的稳定性，平衡结构自身重力产生的力矩，除此之外，使用对称结构的好处是（**就是用起来会更爽，但这里不知道该怎么表达**）。其次，rolling方向连杆做了一些改进，通常操纵者会使用大拇指和食指握住【pincher formation】以控制末端器械如镊子的开合，而其他手指则处于蜷缩状态没有被利用，因此这里添加了一个类似于手枪把手的结构，操纵者可以使用中指控制【】的开合，如手术时所必须的冲洗，吸收积液，充气等操作，为了满足多功能，在按键下面还设置了一个轮盘来切换上述功能。由于三连杆所受到的力较小，因此我们使用树脂作为材料并以3D打印的方式制作，【这种材料的优点介绍一下】；

整个结构可以简化为串联的五连杆，串联运动配置的优点是机械结构更简单，有利于制造并减少潜在故障点，从而减少所需的维护量，同时运动学模型和动力学模型较为简单，为后续人机交互控制降低难度。

为了实现智能交互，操纵台的每个运动关节都配备了电驱一体化的无刷直流电机，内部集成FOC算法，仅需向驱动板发送指令即可实现多种模式的控制，包括增量位置控制，绝对位置控制，速度控制和力矩控制；同时电机还集成了精度为18bit的绝对值磁编码器；我们使用STM32嵌入式单片机作为控制板通过CAN通信协议控制和读取电机的状态，由于交互算法还未设计，因此当前工作集中于数据的采集。



## 手部震颤抑制

介绍一下什么是手部震颤，它的特征有哪些；之前人们尝试了使用哪些方法抑制

* 一种自适应的卡尔曼滤波
* 肘部搭载可以使手指不悬空
* 手握式？好像没有特别明显

震颤过滤是所有遥控操纵的手术机器人需要共同面对的问题，

生理性震颤（Physiologic Tremor）是一种生理性现象，是正常情况下每个人都会经历的微弱的震颤或颤动[3-0]。这种震颤的频率在8-12Hz之间，通常肉眼通常无法感知，但在手术的条件下，生理性震颤是不可忽视的不利因素，The trend towards the use of ‘minimally invasive surgery’ also tends to amplify tremor effects, due to the longer lever-arm action of typical laparoscopic instruments[3-1]，我们主要从软件和硬件两个方面对生理震颤的信号进行了处理，（这里缺少实验结果）。

### 自适应卡尔曼滤波

单个电机的角度信号可以看作一阶系统，建立其状态方程及其对应的参数如下：
$$
公式1；
$$
借助卡尔曼滤波算法进行迭代，可以较为明显的平滑由于生理震颤产生的抖动信号；
$$
公式2
$$
卡尔曼滤波作为最为人知的滤波算法（怎么夸），但是该算法存在两个最缺点，首先它像PID控制一样，需要对公式2中的参数Q与R进行手动调试；其次该算法无法兼顾精度和滤波效果，Q与R的比值会影响滤波结果，比值越小表示预测值的权重越大，最终结果抗干扰越强，但是会丢失一定精度；反之，比值越大越靠近标准值，滤波的效果越不明显。对前一个问题，前人已经提出了许多改进的自适应卡尔曼滤波算法，对于后一个问题，我们在这里提供了一种简单的模型，通过记录前后两次采样角度差值的方法，简易的区分操纵波形和噪声，并根据差值实时修改Q与R：
$$
公式3
$$
其中avg为经验值，通过记录多次噪声取平均值而得，因此diff 与avg的比值表示信号振幅的大小，较大时表示操纵波形，较小时为噪声。图---对比了传统卡尔曼滤波与改良后自适应卡尔曼滤波的效果，图中可以明显看到改良后滤波算法即避免了传统滤波算法引起的失真，又达到了消除抖动信号目的：

图

### 搭载式



## 主从映射推导







## 结论







## Reference

[1] Rosin, R. D. (Ed.). (1993). *Minimal access medicine and surgery: principles and techniques* (Vol. 1). Scovill-Paterson.

[2] Gauderer, M. W., Ponsky, J. L., & Izant Jr, R. J. (1980). Gastrostomy without laparotomy: a percutaneous endoscopic technique. *Journal of pediatric surgery*, *15*(6), 872-875.

[3] Rattner, D., & Kalloo, A. (2006). ASGE/SAGES Working Group on natural orifice translumenal endoscopic surgery: October 2005. *Surgical Endoscopy and Other Interventional Techniques*, *20*(2), 329-333.

[4] Giday SA, Kantsevoy SV, Kalloo AN. Principle and history of natural orifice translumenal endoscopic surgery (NOTES). *Minim Invasive Ther Allied Technol*. 2006;15:373–377.

[5] Fuchs, K. H., & Breithaupt, W. (2012). Transgastric small bowel resection with the new multitasking platform EndoSAMURAI™ for natural orifice transluminal endoscopic surgery. *Surgical endoscopy*, *26*, 2281-2287.





[9] Dallemagne, B., & Marescaux, J. (2010). The ANUBIS™ project. *Minimally Invasive Therapy & Allied Technologies*, *19*(5), 257-261.

[10] Kobayashi, T., Lemoine, S., Sugawara, A., Tsuchida, T., Gotoda, T., Oda, I., ... & Kakizoe, T. (2005). A flexible endoscopic surgical system: first report on a conceptual design of the system validated by experiments. *Japanese journal of clinical oncology*, *35*(11), 667-671.





[2-1] Kuniholm, J. F., Buckner, G. D., Nifong, W., & Orrico, M. (2005). Automated knot tying for fixation in minimally invasive, robot-assisted cardiac surgery.
