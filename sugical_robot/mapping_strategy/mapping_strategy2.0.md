# mapping_strategy2.0

新的机构构型可以简化成下图，对应的坐标系配置：

[简单画一张图]

主端的关节空间为 $[\theta_1, d_2, \theta_3, \theta_4, \theta_5]$，从端的关节空间 $[D_1, ks_2, \Phi_3, ks_3, \Theta_5 ]$



因为主从结构均为欠驱动结构，无法同时保证主从位置和姿态一致，手术中姿态的重要性大于位置（**这里有点像WBC的控制策略啊**），因此首先需要确保手指朝向和手术器械朝向一致，也即在工作空间上，两者姿态对应向量  $\vec{u_m}$  与 $\vec{u_s}$ 相等；

关于相等的推导，这里是采用的解耦的求解策略，也即theta1等于ks2， 剩余3个角度$\theta_3, \theta_4, \theta_5$ 与 $[\Phi_3, ks_3, \Theta_5]$的映射策略之前已经推导得出。这里主要推导一下从主端驱动空间 $[\alpha_1, \alpha_4, \alpha_5]$到关节空间 $[\theta_1, d_2, \theta_3]$的求解过程；
$$
\theta_1 = \tan^{-1} \frac{y_c}{x_c-0.5},x_c != 0.5 \\
\theta_3 = \alpha_5 - \Delta\theta \\
where,  \Delta\theta = \pi - \alpha_0 - \alpha_3 - \alpha_4 - \theta_0
$$
其中，theta_1 表示五连杆末端点与中心位置O坐标系形成的夹角，theta3表示坐标系3与坐标系2之间的夹角；而α5表示电机实际转动的角度（这里电机实际转动的角度不等于theta3，所以需要推导）

因此满足下面条件即可保证姿态相等：
$$
一个矩阵
$$
当满足第一优先级任务以后，



采取解耦映射方法，也即5连杆部分对应近端连续体的运动；3连杆部分对应远端连续体+手术器械的运动





