# 科研手册

来学校也已经3个月了，主要是在上课，但也花了一些时间在科研上，主要是看论文，零零碎碎的看了一些，主要是花在研究手部的震动上，但研究效果不佳，原因主要是这个研究比较冷门，而且目前很难用工程去解决这个问题；

想暂停一下这方面的研究，主要原因有以下几点：

* 临床上只在现象上描述了手部的生理震颤，并没有从根本解释震颤的原因（就算有，也无法使用工程的方法从根源上解决震颤
* 之前说要用装置检测生理震颤与手部信号之间的关系？
  * 首先我没有EMG这方面的基础
  * 其次生理震颤如此微弱的信号，在手指末端较为明显，小臂和大臂肌肉估计是很难捕获到
  * 这些都使得生理震颤肌肉信号的检测很难实现
* 而我们最初的工程目标，仅仅只是抑制手指末端震颤带来的影响。这个通过变阻尼-刚度控制方法应该可以实现，也即大幅度运动时采样小刚度-阻尼，而小幅运动，或者保持静止时大刚度-阻尼

综上所述，监测手部生理震颤信号不是唯一解，也不是最优解，还有其他方法用于判断操纵者手部控制状态：

* EMG检测手部肌肉

* 加速度计+IMU判断手部运动状态

这样的话，上周那篇论文也不是白看了，通过融合滤波实现手部运动状态的识别



3-25更新：

​	为了发表ICARM会议论文，项目推进了不少内容，完成了主体的搭建和电机的初步调试；但是很多细节仍需要进行完善，下一个环节是整合我这边和亦达的部分，实线初步实验，然后在此基础上改进。为了能达到拿来用的水平，还需要完成很多工作：

* [x] finger gripper 的结构完善
* [ ] 养成强度校验的习惯
* [ ] 肘部夹持怎么优化
* [ ] 运算在哪里处理呢？我是说mapping的内容；如果在我的stm32上，那就最后传输的是从端的构型空间，无所谓了，大不了都传
* [ ] 主从之间如何通信
* [ ] 关于自己之前一直想做的



另外也要为自己考虑，可以把做出来的东西转化成专利：



3-27 ：初次提交论文后，开始完善手部grip的搭建



4-18更新：

​	gripper部分搭建大致完成，准备装配出实物看看效果，可以的话真的想去写个专利，毕竟也做了一两个月；如果要写专利，那就需要做一些理论上的工作：

有一个很在意的事情，到现在我没有找到太多关于手术机器人把手的资料，因为这个比较小，而且它的**学名到底叫什么！！！**（达芬奇专利叫他 hand held part; 两篇论文都提到了pinch grip type和the power grip type.；gripper）

surgical robotic master console pinch grip

* [x] 研究人体手部解剖学，研究较好的把握姿态
* [ ] 查一下别的公司这方面的专利





## 手部运动状态检测装置设计

首先，要分析一下，这样一个装置是不是必要的，因为，就目前连杆的结构而言，不需要

之前研究了人体手部震颤相关的原理；了解了其大致种类，生理原理，诱发原因，主要特性等；但是由于神经解剖学过于复杂，很难做到在根源上消除抖动；

因此打算改变侧重点，主要先研究医生在手术时出现的抖动情况，再找一下普通人的相关数据——因为，我们希望我们的设备，能够保证医生在很累，或者实习医生手抖比较明显的情况下，克服这个抖动

* 当然，我一直觉得，增加关节的阻力是一个很好的消除抖动的方法；也不一定，

相关文章:

[临床医生震颤](https://academic.oup.com/icvts/article/23/3/410/1749883)



### 无刷电机选型



| -                                                            | 额定扭矩(Nm) | 堵转扭矩(Nm) | 尺寸(D,W_mm) | 质量(g) | 价格 |
| ------------------------------------------------------------ | ------------ | ------------ | ------------ | ------- | ---- |
| [HT3510](https://item.taobao.com/item.htm?id=541974032557&price=110-170&sourceType=item&sourceType=item&suid=c557422a-d396-4647-9955-912a780a9aa6&shareUniqueId=24219330256&ut_sk=1.ZCqn0g5LfBQDAJU0cqw9myYs_21646297_1699976702203.TaoPassword-QQ.1&un=32beb8314c8c26ae69e853a82a8667b3&share_crt_v=1&un_site=0&spm=a2159r.13376460.0.0&sp_abtk=gray_1_code_simpleAndroid2&tbSocialPopKey=shareItem&sp_tk=TjA3OFczNWNNbko%3D&cpp=1&shareurl=true&short_name=h.59mjHCS&bxsign=scdD4SNds2JY8LAejbRlaF2cHZ0bnrbuom0wnyfyPPWJK4xFZVTLp6WUyjpJYbiHopkgTLLe_-Hh8qQteMDhT0dFxRq8EYA6hByM6gpKMREWCN5KJ09TPur8SUddQtUhiTA&tk=N078W35cMnJ&app=chrome) | 0.13         | 0.16         | 40x25        | 73      | 170  |
| [HT4310]()                                                   | 0.25         | 0.37         | 49x24        | 113     | 240  |
| [HT4315](https://item.taobao.com/item.htm?spm=a1z10.5-c-s.w4002-18530239084.30.56cf71e73SiGRc&id=557446002311) | 0.65         | 0.8          | 49x31        | 158     | 240  |
| [HT5225](https://item.taobao.com/item.htm?spm=a1z10.5-c-s.w4002-18530239084.18.56cf71e73SiGRc&id=541701409289) | 0.45         | 1            | 59.6x43      | 330     | 305  |
| [HT6010]()                                                   | 0.8          | 0.9          | 68x30        | 247     | 260  |
| [HT100](https://item.taobao.com/item.htm?spm=a1z10.5-c-s.w4002-18530239084.32.56cf71e73SiGRc&id=558192875037) | 1.6          | 3            | 98.5x35      | 520     | 860  |
| [3](https://item.taobao.com/item.htm?spm=2013.1.w4004-18530239073.10.4c1717533HQrxr&id=569863396306) |              |              |              |         |      |
| [4](https://item.taobao.com/item.htm?id=602811939035&price=899&sourceType=item&sourceType=item&suid=25adeb1e-967a-4710-bebe-1503fe4e73e4&shareUniqueId=24228653984&ut_sk=1.ZCqn0g5LfBQDAJU0cqw9myYs_21646297_1700039516217.TaoPassword-QQ.1&un=32beb8314c8c26ae69e853a82a8667b3&share_crt_v=1&un_site=0&spm=a2159r.13376460.0.0&sp_abtk=gray_1_code_simpleAndroid2&tbSocialPopKey=shareItem&sp_tk=RWNLSlczaXJMRFA%3D&cpp=1&shareurl=true&short_name=h.5Q9giLj&bxsign=scdM22FPZ8IT_mBYKVgIG5eso-hq2ubDKey1OHX70MrL_es9O2LRGmy9_e-CMWbec5OnvPYLtsvgL4y2mhd-49RutaRMcJSHNwp89xtBNFJoti8fA9GYc--9GJaI6oEt7Fd&tk=EcKJW3irLDP&app=chrome) |              |              |              |         |      |

目前购买的是MF4015，额定扭矩是0.25NM，非常的高，最大扭矩能达到0.65，好像我不太需要这么大扭矩的电机，MF4005系列，扭矩小，体积也小，但是转速很快，似乎也不是我想要的，

以MF4015为参照物，我需要，扭矩更小的，还能实现FOC的电机3个；

同时问一下，ME系列都是不带驱动吗，我想买ME1605或者2605，但是似乎都是电驱一体的，就是要自己配驱动对吧。

目前来说，电驱一体力矩最小的只能选MF4005或者4010了，

还有另一条选择，选择ME+外带的驱动器，就是电机和驱动器分离的；这样会麻烦一点，但是可选的选项多一点

| -      | $\tau_0$ | $\tau_{max}$ | 精度 |
| ------ | -------- | ------------ | ---- |
| MF4015 | 0.25     | 0.65         |      |
| MF4005 | 0.07     | 0.25         |      |
| MF4010 | 0.15     | 0.33         |      |
| ME3506 | 0.06     | 0.09         | 14   |
| ME2605 | 0.04     | 0.06         | 14   |
| ME1605 | 0.01     | 0.01         | 14   |
|        |          |              |      |
|        |          |              |      |







### 结构转动惯量计算

| 转轴         | 转动惯量 |
| ------------ | -------- |
| pitch        | 2500     |
| yaw          | 7500     |
| 近端偏转关节 | -        |



## 变阻尼刚度结构

这个结构一定是要实现的，因为是消除抖动和实现力反馈的核心基础；

因此本周(11.9)可以先看一篇变刚度阻尼的文章，看看前人是如果实现这个功能的

在此基础上，学习、复现、改进功能







## 机械结构迭代

反思之前的结构，可以发现存在一些很明显的问题：

* 三连杆的结构，使得人体手指只能在一个弧面上运动，因此手指会比较别扭
* 5个串联关节直接运动不柔顺，原因如下：
  * 手臂和手腕分离控制，两者之间会相互影响
  * 微创手术的操纵端是可以全自由度自由运动的；而我们目前把



* 为什么要用电机而不是编码器
  * 首先，我认为，过于丝滑并不是一件好事情，它会出现一下两种不良结果：
    * 稳定性差，稍微有一些扰动，就会跳变
    * 无法实现定位，一松手就会垮掉
  * 其次，为什么要使用电机
    * 第一，达芬奇手术机器人的操纵端(console)就是使用的电机，而不仅仅是使用编码器，这个在这个[视频](https://www.youtube.com/watch?v=teRQr2qquJA)里面显示的很清楚了
    * 电机是升级版的编码器，它可以解决上面这些问题
    * 同时，通过算法设计，还可以实现更柔顺的控制
  * 关于一些质疑点：
    * 电机减速器妨碍人体运动：因为这是云台电机，额定扭矩够小，所以并没有出现明显的阻碍，这个可以通过数据来说明
    * 成本，电机成本大约是编码器的43-5倍

#### 一种贴合手肘的开关

设计目标：

* 可以放置手肘，让手肘很舒服
* 可以跟随手肘在平面上运动
* 能够调节位置



关于这个主体的设计，目前有几个想法：

1. 最简单就是一个球窝，与手肘贴合的地方使用较为柔软且摩擦系数较大的材料；
2. 在1的基础上，添加一个开合的结构，关于开合，可以用之前的弹簧结构？
3. 类似于柔性抓手？但是不知道抓力够不够



#### 肘部底座移动

根据陈老师的建议，底座可以变成平行四边形。对比一下它与正交导轨的优缺点

| -              | 优点                                           | 缺点                                                         |
| -------------- | ---------------------------------------------- | ------------------------------------------------------------ |
| 正交导轨       | 搭载效果比较好，可以搭载较大的平台             | 暂时不知道同时移动两个导轨效果如何，会不会卡住；需要配合额外的传动才能和电机转轴配合 |
| 平行四边形连杆 | 结构更简单；可以直接在转轴上配合电机或者编码器 | 怎么把手肘+三联杆放在这个四连杆上呢                          |



同时陈老师推荐



### 齿轮选型

md，齿轮这个东西，学了很多遍，参数什么的都记不住

最重要的三个参数：

模数：决定齿轮齿大小的参数

压力角：决定齿的形状

齿数：。。。

其它参数都可以根据这个算出来





* 中心距计算

  ![](http://www.jschitiao.com/upload/image/20200226/15827162295337507.png)

![](齿轮齿条.png)

安装距Hb=H0+D0/2 = 19

H0齿条节线高度（齿条总高度减去模数M）= 10-1 =9

D0齿轮分度圆直径（模数M乘以齿数Z）=  20

目前我要确定的是装配孔到转轴的距离 l1 = 19 - 3.9 =15.1



陈老师不推荐使用齿条：

* 悬臂梁，不稳定——解决方法，两端固定
* 没有进行比较好的封装：可能会卡到手什么的

推荐使用同步带，但是同步带有一个不太好的地方是，无法比较好的测量平动



### 打印

下面这些，几何比较复杂，发未来工厂打印

| 名称                 | 数量 | 备注                           |
| -------------------- | ---- | ------------------------------ |
| roll_link_main       | 1    | roll杆主体                     |
| 指夹                 | 2    | 需要确定传感器后确定最终版本？ |
| link_pitch_dual_main | 2    | 俯仰杆主体                     |
| link_pitch_2_right   | 1    | 俯仰杆前端-右                  |
| link_pitch_2_left    | 1    | 俯仰杆前端-左                  |
| yaw杆架_up           | 2    | 偏航杆上半部分                 |
| 配重连接件           | 2    | 连接配重块                     |
| yaw杆架_ver3_left    | 1    | 偏航杆主体-左                  |
| yaw杆架_ver3_right   | 1    | 偏航杆主体-右                  |

下面这些，几何参数比较简单的，使用实验室打印机







### 装配

#### 滚动部分

获得所有零件以后，先将扭簧固定在圆柱体中；并用502加固，然后将电容压感传感器安装到两个手指夹上；再将手指及和压簧进行配合，并使用M2螺栓将其固定；

最后将圆柱体，与编码器进行固定（目前是编码器，后面不知道要不要换成电机）

#### 俯仰部分

关于pitch杆与编码器的连接——直接套上去就行，

pitch和yaw的连接也很简单，没问题

配重重新验算了一遍，没有啥问题，可能有一点的问题是，配重连接块和pitch杆连接的时候，**没有空间再上螺母，只能光凭螺纹固定**

#### 偏航部分

与电机连接，也是标准的连接；不过要先把电机固定到板子上

至此，RPY三个部分装配好了



#### 导轨装配

必然是要从下往上进行装配

先装第一层导轨，，然后将固定电机的部分装配到纵向板子上，将纵向板子固定到滑块上，

固定好齿条和电机到横向板子上

固定横向导轨，将横向板子固定到横向导轨

ok，差不多！



### hand grip

设计目标：即使传统的内窥镜把手上也有很多功能键按钮，为了实现手术机器人操控的高效性，需要至少在hand grip部分实现传统内窥镜的所有功能，通过左右手配合，实现1个人完成需要多人配合的任务



3.00mm

#### 拉簧选型

[跳转到弹簧选型](./manipulator_design/grip_part/grip_4_links_modle.md)



#### 按钮调试

1. 选择调试串口
2. 开通引脚，测试通过



#### pincher部分设计

首先要明确一个事情，我需要准确的摁压角度，还是只需要检测是否被摁压；为了

目前在这个上面遇到了比较大的阻碍，一时不知道该如何去设计，首先明确一些目标和任务吧：

* 要做到同步开合，因此角度肯定是要检测的
* 陈老师提出的，当夹持到组织以后



#### 无名指旋钮

这部分首先要完成的任务是，选择合适的电器元件，实现旋转的切换：

关于具体要实现哪些功能？

* **Suction**: remove fluids, debris, or tissue fragments to maintain a clear view.
* **Irrigation**: deliver fluids to cleanse the surgical area, remove blood, and improve visibility.
* **Drug Delivery**: deliver medications directly to specific areas within the body.
* **AIR insuffulator**: 
* **camera**

![image-20240401130747897](C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240401130747897.png)

目前能够选择的电子器件包括：电位器、旋转按钮、微型编码器

| -          | 优点                             | 缺点                                                   | 尺寸(d x h)         |
| ---------- | -------------------------------- | ------------------------------------------------------ | ------------------- |
| 电位器     | 价格便宜，能通过程序灵活设置挡位 | 需要额外设计程序，将阻值设置为挡位                     | 22 x 18 + 6x22      |
| 旋转按钮   | 挡位分明                         | 需要较大的力气拨动旋钮，不够顺滑，且挡位越多电路越复杂 | 29 x 12 + 10 x 13.5 |
| 微型编码器 | 非常顺滑，精度高                 | 贵，有点大材小用                                       | 15x17               |

经过实验和测试，决定使用电位器；

接下来一步需要进行电位器调试和功能实现。电位器的调试可以直接使用正点原子代码，要实现功能，先编写代码逻辑：

ADC通道会读取一个值：adc_value：0-4096

如果我需要n个功能，那就是需要将4096个值分成n等分

使用case函数实现多个功能；也即输出多个结果



为了看一下别人是怎么设计的，这里专门去找了一下专利

* [专利一](https://pss-system.cponline.cnipa.gov.cn/documents/detail?prevPageTit=changgui)

* 受力分析

  具体的推导过程见 [四连杆力学模型](./manipulator_design/grip_part/grip_4_links_modle.md)

* 四连杆长度的确定，需要满足最大最远两个距离的限制

* 夹紧部分：夹紧部分的设计是为了在位控和力控之间切换；具体的结构和尺寸设计，见手记本
  * 夹紧部分的出发使用扳机+曲柄滑块实现；
  * 首先绘制出末端位置与theta之间的关系见文件【x_slide-theta】，为了满足连杆长度尽可能的小，将theta的活动范围锁定在x变化率最大的范围，同时满足最大值约束和行程约束，通过绘制出【x_slide-theta-slope.fig】确当theta范围为[pi/4, 5pi/12]（不对，这个范围永远会超过最大值限制，所以要先通过最大值确定theta的最小值）；求解出来L1 = 5.4；L2=9.8； theta_i = 37.7，对应行程x = 3
  * 
  * 



#### pinch_handle BOM

| -                | -    | 是否有发票 |
| ---------------- | ---- | ---------- |
| M2 x 30 双头螺杆 | >2   | 11         |
| M2 x 14 双头螺杆 | >1   | 11         |
| O8I4B3  轴承     | 4    | 11         |
| O5I2B2.5  轴承   | 4    | 11         |
| O3IiB1 轴承      | 4    | 11         |
| 大小齿轮         | 2    | 11         |
| 编码器           |      |            |
|                  |      |            |



**有限元分析**：

51假期回来以后学习了一下有限元，使用有限元分析了一下目前模型的结构强度






## 算法设计

这里是重点做文章的地方

无刷电机：BLDC

### 变刚度控制

搜索了无刷电机通过算法实现[弹簧阻尼]系统，有视频，但是没有讲怎么实现

突然想清楚一个事情，所谓变刚度，电机里面没有弹簧的和阻尼的，无论如果，你改变的只有输出的力，那就是，根据检测到的位置和和速度，结合你想要的K和D，就能计算出那个模型下对应的力矩，也就实现了所谓的变刚度，而现在FOC在底层已经给你实现了，那你需要改的只有电机输出的力矩，这不是很简单嘛！

[这是这个成熟的FOC旋钮项目](https://github.com/scottbez1/smartknob/?tab=readme-ov-file)

* 用电机实现弹簧阻尼模型

  ![](老子又开始玩嵌入式了/v2-6f7441b8934ca8ff532c31b67cc720a6_720w.webp)
  $$
  F_{simu} = c \dot{q} + kq
  $$
  所以只用知道$\dot{q} + q$ 就能求出模拟的力，得到模拟的效果

  其中速度和位置都能通过编码测量出来，所以第一步，先看电机如何获取位置
  




### 变阻抗控制





### 如何判断state

现在是在搭一个简单的spring-damping 模型





## LOG

2024-1-5

 电机目前还在调试，感觉只差临门一脚了

如果能够实现目前这些功能：力矩，速度，位置

那我应该如何设计程序，实现我想要的功能呢

首先回答一下陈老师的问题：为什么不用编码器而是使用电机：



1-8 —— 1-9 都在修改机械结构

1-9：主要是注重齿轮和齿条的选择和设计





## 购买清单

[正齿轮](https://item.taobao.com/item.htm?id=40871095716&spm=a1z10.5-c-s.w4002-23781110036.13.73685ce9DFA1UE&skuId=4933148908846)

[齿条](https://item.taobao.com/item.htm?app=chrome&bxsign=scdxU6UZlD8STx8e0B3WOeNbG_oSU-mxxm6c8RZckjZ9J39XTlCU05NI5leP5mb9aOuXSJVe_P5BYj2HyYmSdQWn7Ws9PzyCn53TsVBLv9KUxpFqvej3YDS5BOIyga3U52e-NQ0ugacVtShJFxODJ11lw&cpp=1&id=40857110379&price=5.4-315&shareUniqueId=25046855230&share_crt_v=1&shareurl=true&short_name=h.5LKwapoE6ZBxnht&skuId=4936465785162&sourceType=item,item&sp_abtk=gray_1_code_simpleAndroid2&sp_tk=dktaZFdoS0dqQnA=&spm=a2159r.13376460.0.0&suid=1e254251-4eba-4384-88b0-6104b429fce9&tbSocialPopKey=shareItem&tk=vKZdWhKGjBp&un=e82a4c002eac03ff66b6cdab846c86ba&un_site=0&ut_sk=1.YrP3DXm%20P/8DAHTCsSqRTDiZ_21646297_1704769421744.TaoPassword-QQ.1)

[电机还要买](https://shop343206944.taobao.com/shop/view_shop.htm?shop_id=343206944)

[标准螺栓](https://detail.tmall.com/item.htm?app=chrome&bxsign=scdhHyCvblpQviJvM8zHlpSDlCNV7ZFsaTZeG89VEPWY1itVGhGe77yV9Lt_4502u3tMVQHC0KrHYo7y866ae69vCJJlWb5aSMXnM9oxHhlDI8Y3Hlro2NTxXdkT3BzOVHi3S5h6cMZPZhaB9Jnse_VXQ&cpp=1&id=587639753812&shareUniqueId=25051646208&share_crt_v=1&shareurl=true&short_name=h.5LsdUseJ8RPTc9P&skuId=4942035267147&sourceType=item,item&sp_abtk=gray_1_code_simpleAndroid2&sp_tk=T1ZuSFdoc1kwZU8=&spm=a2159r.13376460.0.0&suid=cb84e320-dcff-4180-b3e2-c89ec06c4df1&tbSocialPopKey=shareItem&tk=OVnHWhsY0eO&un=e82a4c002eac03ff66b6cdab846c86ba&un_site=0&ut_sk=1.YrP3DXm%20P/8DAHTCsSqRTDiZ_21646297_1704792246273.TaoPassword-QQ.1)、[平头螺栓](https://m.tb.cn/h.5K8AlHuOl5X6pWB?tk=HhR5WS1M5R5)

[螺母]()

[把手]()

[扭簧]()





## TO-DO-List

- [ ] 查一下怎么写专利——没做
- [ ] 设计一下肘部结构——然后找陈老师讨论一下——设计的不太行
- [ ] 查一下扭簧怎么装配——用不到了
- [ ] 研究一下“串联L三连杆”——开始打印，这个结构很好



2-19-2.29

- [ ] 调电机似乎不是当务之急——但是我喜欢搞这个，有空还是搞好
- [ ] 明确手术机器人的应用场景
- [ ] 打印好3连杆以后，改进前面部分结构



- [ ] 肘部结构仍不知道怎么去改进设计
- [ ] 改完先打印一个简单的试一试
- [ ] 



要干的事情其实很多，但是太多了又一下子不知道从何处做起，最后一个星期了，想想能做些什么吧；整体设计来说；手腕我暂时不知道怎么改才好
