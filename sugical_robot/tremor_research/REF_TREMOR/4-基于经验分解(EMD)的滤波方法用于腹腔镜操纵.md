# 基于经验分解(EMD)的滤波方法用于腹腔镜操纵

## 介绍

论文介绍了手术中由于肌肉疲劳引起的手部震颤问题，这种震颤会影响腹腔镜手术的精确度。震颤信号具有非线性和非平稳的特性，使得传统的固定截止频率滤波器难以有效消除震颤。为了应对这一挑战，论文提出了一种基于经验模态分解（EMD）的滤波方法，通过分析内在模态函数（IMF）的概率分布特性来过滤震颤信号。该方法在不同疲劳水平下表现出对震颤信号的良好抑制效果，同时保留了手术工具的预期运动轨迹。



## 方法

### EMD

这个方法很成熟了，可以在网上找到很多资料

1. **选择信号**：选择受到震颤影响的手持内窥镜操作轨迹信号 *x*(*t*)。
2. **确定极大值和极小值**：在信号中识别出所有的极大值和极小值点。
3. **生成包络线**：通过对极大值和极小值点进行插值（通常使用三次样条插值法），分别生成上包络线和下包络线。
4. **计算包络均值**：计算上包络线和下包络线的均值 envmean=(envmax+envmin)/2，然后计算中间信号 *d*(*t*)=*x*(*t*)−envmean(*t*)。
5. **判断IMF特性**：检查 *d*(*t*) 是否满足IMF的两个标准（零交叉点与极值点数量接近，上下包络线均值为零）。如果满足，*d*(*t*) 被保存为一个IMF，并从原信号中减去，开始下一轮迭代处理剩余信号；如果不满足，则对 *d*(*t*) 继续重复上述步骤。
6. **重复迭代**：不断重复上述过程，直到剩余信号变为单调序列（即不再包含足够的振荡成分）。

### 测量手指（器械）震颤情况

文中使用的是IMU，测量小臂和 手部的加速度，然后根据二连杆模型，预估抓握处的震颤，最终得到末端的位置和姿态信息。



### 通过概率决定参数

论文将手术中受到震颤影响的手持内窥镜运动表示为：

*x*(*t*)=*x*in(*t*)+*x*fi(*t*)+*x*hf(*t*)

其中：

- *x*in(*t*)：表示预期的手部运动（即手术过程中医生有意的操作部分），这种运动通常是低频的，不会因疲劳而发生变化。
- *x*fi(*t*)：表示由肌肉疲劳引起的震颤（FIT, Fatigue Induced Tremor），其频率会随着疲劳程度的增加而发生变化。
- *x*hf(*t*)：表示高频噪声（如系统性震颤），其频率大约在30Hz左右，相对于预期的运动是高频部分，基本上是恒定的。

#### 信号重构的目标

信号重构的主要目标是通过选择适当的IMF阈值，从原始信号 *x*(*t*) 中提取出接近于预期运动的信号 *x*^(*t*)，即滤除震颤部分，使得：

*x*^(*t*)=*i*=*m*∑*n*IMF*i*(*t*)+*r*(*t*)

其中：

- *m* 是重构的起始IMF索引，决定了哪些IMF是被保留下来的。
- *r*(*t*) 是残余信号，是在EMD过程中无法进一步分解的部分。

#### 关键问题：如何选择IMF的阈值 *m*

选择合适的IMF阈值 *m* 是关键，因为不同的IMF包含了不同频率的运动成分。论文提出了一种基于概率分布不对称性的统计方法，即对相邻IMF进行概率分布对比，以确定哪些IMF包含震颤信号。

具体方法是利用**对称Kullback–Leibler散度**（SKLD），这一方法可以量化相邻IMF之间的概率分布差异：

SKLD∣*P**i*→*P**i*+1=21(KLD∣*P**i*→*P**i*+1+KLD∣*P**i*+1→*P**i*)

SKLD能够抵消方向性的不对称性（即从 *P**i* 到 *P**i*+1 与从 *P**i*+1 到 *P**i* 的差异）。通过计算IMFs之间的SKLD值，找出最大的SKLD，即找到概率分布差异最大的两个相邻IMF，作为震颤信号和预期运动的分界点。

#### 实际应用：如何根据SKLD选择阈值

1. **计算SKLD值**：对所有相邻的IMF对计算SKLD值。
2. **确定IMF阈值**：找出SKLD值最大的IMF对，以此作为IMF的阈值 *m*，表示低于这个IMF的分量大概率为高频震颤部分，应该被滤除。
3. **重构信号**：根据这个阈值，保留比阈值IMF更高的IMF用于重构信号 *x*^(*t*)，从而获得去除震颤的预期运动信号。



## 实验设计

实验招募了不同年龄和技能水平的志愿者（包括有经验的外科医生和新手），让他们在实验中执行手持内窥镜的操作任务，以模拟实际手术中的情况。实验设置包括使用肘部支撑来模拟机器人辅助手术的场景，并通过表面肌电图（SEMG）和加速度传感器记录手臂和手掌的运动数据。受试者被要求进行动态轨迹跟踪和静态保持的任务，以观察在长时间操作中因肌肉疲劳引起的震颤变化，从而验证EMD基于震颤过滤的方法的有效性。



## 实验结论

4.1 

通过横向对比6次实验信号幅度，PSD得出下面结论：随着肌肉疲劳的增加，震颤信号的频率和幅度均有显著变化，高频部分增加。这种现象表明，手部震颤并不是固定的，而是随着肌肉状态动态变化的，需要适应性更强的信号处理方法进行滤波。

同时，震颤信号的非线性和非平稳特性在不同任务阶段的量化分析中得到了体现。通过Quantile-Quantile (Q-Q) 图，显示震颤信号相对于正态分布的偏离程度，证明震颤信号具有非线性特征且在疲劳状态下表现得更为显著。

4.2+4.3

**IMF的分解结果**：EMD分解将震颤信号 *x*(*t*) 分解为多个IMF，从IMF1到IMF13，每个IMF代表了信号中的不同频率成分。实验数据中，IMF的顺序越低（如IMF1、IMF2），频率越高；而IMF的顺序越高（如IMF12、IMF13），频率越低，幅度越大。IMF的这种频率递减特性确保了高频的震颤被分离出来，而低频的预期运动保留在后续的高序IMF中。

**IMF频率变化**：随着任务阶段的推进（从TE-1到TE-6），震颤信号中的高频成分逐渐入侵到更高序的IMF中。也就是说，随着肌肉疲劳的增加，震颤信号不仅在强度上增加，还逐渐影响到更低频的IMF。这表明震颤在任务进行的过程中变得更为显著，影响范围更广。

**零交叉点的数量**：IMF的零交叉点数量随IMF序号的增加而减少。实验显示，较低序IMF（如IMF1）具有最多的零交叉点，表明它们主要包含高频成分；而较高序IMF（如IMF13）几乎没有零交叉点，主要代表了低频的预期运动。

**IMF概率分布的特性**：通过分析IMF的概率分布，可以看出低序IMF和高序IMF的分布差异明显。低序IMF通常呈现更接近于正态分布的形态，具有较小的振幅和较高的频率，这与震颤信号的高频特性相符。而高序IMF则表现为低频、大幅度的分布，主要包含预期的手术操作运动。



4.5 

论文对基于EMD分解的震颤消除方法进行了模拟测试，以验证SKLD设定重构阈值的有效性。这部分主要利用合成的震颤信号进行实验，以更好地理解和展示该方法在不同震颤特性下的表现。

#### 主要内容

1. **合成震颤信号的构建**：

   合成信号由两个主要成分组成：低频的正弦波（代表预期的运动）和高频的噪声（代表震颤）。这些信号被用来模拟实际操作中因手部震颤而产生的复杂运动轨迹。通过调整噪声的频率和幅度，可以模拟出不同疲劳状态下的震颤特性。

2. **EMD分解和IMF阈值选择**

   对合成信号进行EMD分解，得到一系列IMF，然后通过计算相邻IMF的SKLD值来确定重构的阈值IMF。重构过程保留高于阈值的IMF，以保留预期运动并消除震颤信号。

3. **信号重构和验证**：

   实验显示，通过这种方式得到的重构信号能够成功滤除震颤部分，同时保留预期的低频运动。这种重构结果也在频域（FFT分析）中得到了验证，显示震颤信号在重构后显著减少。

4. **结果展示**：

   图示显示了在不同合成震颤信号下，IMF的阈值是如何随着震颤频率和幅度的变化而调整的。这表明EMD和SKLD的组合方法在不同震颤条件下具有适应性和灵活性。



4.6部分主要对实验中的实际震颤数据进行了分析，验证了基于SKLD选择IMF重构阈值的有效性。

1. **震颤特性在不同任务阶段的变化**：

   在不同的任务阶段（Task Epochs），随着时间的推移和疲劳的增加，震颤信号的频率和幅度都有显著变化。这些变化使得震颤信号影响的IMF序列逐渐从低序IMF向更高序的IMF延伸。

2. **IMF阈值随疲劳水平的变化**：

   在实验数据中，通过计算相邻IMF的SKLD值，找到了各个任务阶段的IMF重构阈值。实验发现，随着任务阶段的推进，IMF阈值从较低序IMF逐渐向更高序的IMF移动。这与疲劳引起的震颤变化相符，即高频震颤成分逐渐侵入更高序的IMF。

3. **重构阈值的选择和效果**：

   每个任务阶段的IMF重构阈值由最大SKLD值确定，实验结果显示，通过这种方式选择的阈值能够适应震颤随疲劳的变化。重构的信号能够在保留预期运动的同时，有效地滤除震颤。

4. **肌电图（SEMG）均值频率验证**：

   为了验证IMF阈值与疲劳水平的相关性，实验中记录的肌电图（SEMG）信号显示，随着疲劳的增加，肌肉的均值频率下降，这与IMF阈值的变化趋势相符，进一步证明了选择IMF阈值的合理性。



4.7 是对最终算法在实验上验证的结果，说实话看起来挺鸡肋的



## 点评

1. **创新性方法：** 文章提出了基于经验模态分解（EMD）结合对称Kullback-Leibler散度（SKLD）的滤波方法，针对生理震颤的非线性和非平稳特性，设计出一种自适应的滤波策略。这种方法不同于传统的固定频率滤波器，通过动态调整IMF的选择，可以更好地应对震颤信号频率和幅度的变化，具有一定创新性。
2. **对复杂问题的实际应用：** 论文关注的是在腹腔镜手术中由于肌肉疲劳引起的震颤问题，这是一个临床上具有挑战性和现实意义的问题。文章不仅仅停留在理论探讨，而是通过实验验证了方法的实际效果，为未来手术机器人和智能辅助系统的开发提供了参考。
3. **详细的实验设计：** 文章通过对不同技能水平和疲劳状态下的受试者进行多次实验，确保了数据的多样性和广泛性。实验设计考虑了静态保持和动态操作两种任务模式，较好地模拟了手术场景，增加了研究的实际应用价值。
4. **数据分析方法的合理性：** 使用功率谱密度（PSD）、频谱相关性分析和肌电图（SEMG）验证了震颤特性的动态变化及滤波效果。这些方法能够较为全面地展示震颤信号在不同疲劳水平下的特性，为结果的可信度提供了支持。



### 不足之处：



1. **结论冗长且缺乏重点：** 您提到的结论部分过于冗长确实是一个问题。文章在结论中重复了一些实验结果，没有充分提炼出最具说服力的发现。这样的写作方式可能让读者失去兴趣，也未能充分强调该算法的优势和独特性。
2. **与其他方法的对比不够深入：** 尽管文章提出了一种新颖的滤波方法，但缺乏与其他现有震颤滤波方法（如小波变换、卡尔曼滤波等）的详细对比分析。文章中没有足够的数据或定量结果来展示该算法在精度、实时性或计算效率上的明显优势，这削弱了文章对方法创新性的论证。
3. **实验数据处理缺乏严谨性：** 实验结果虽然展示了震颤滤除的效果，但对数据处理的细节缺乏充分描述，尤其是在选择IMF阈值的过程中，如何定量确定SKLD的有效性未被充分讨论。此外，对于个体差异和任务复杂性带来的数据波动，文章缺乏进一步的分析，这可能会影响结果的泛化性。
4. **缺少对临床实际应用的讨论：** 尽管文章展示了方法在实验中的有效性，但缺少对实际手术应用场景中的讨论。例如，如何应对不同手术工具和操作环境的变化，滤波器的参数如何在临床中自适应调节，文章都未作深入分析，这使得该方法的实用性和可行性受到一定限制。
5. **缺乏算法计算复杂度的分析：** 文章没有讨论EMD和SKLD方法在实际运算中的计算负担和效率，特别是在实时手术场景下，这可能是读者关注的重点之一。算法的计算复杂度直接影响其在实际手术机器人或手术辅助系统中的应用潜力。